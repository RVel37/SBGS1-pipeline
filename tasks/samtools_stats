version 1.0

task samtools_stats {
    input {
        File bam_file
    }

    command <<<
        mkdir bam_stats_output
        BASE=$(basename ~{bam_file} .bam)
        samtools stats ~{bam_file} > bam_stats_output/${BASE}_stats.txt
    >>>

    output {
        Array[File] stats_files = glob("bam_stats_output/*")
    }

    runtime {
        docker: "swglh/samtools:1.18"
    }
}
# Example metrics
# Read length frequency
# Raw total sequences: Total reads in the file.
# Reads mapped: Total number of mapped reads.
# Reads duplicated: Reads marked as duplicates.
# Insert size average: Mean insert size between read pairs

